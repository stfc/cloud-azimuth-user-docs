<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../platforms/kubernetes-cluster-addons/monitoring/">
      
      
        <link rel="next" href="../../quotas/quotas/">
      
      
      <link rel="icon" href="../../assets/images/UKRI_STFC_Square_RGB.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Identity Provider - STFC Azimuth Science Platform</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-identity-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="STFC Azimuth Science Platform" class="md-header__button md-logo" aria-label="STFC Azimuth Science Platform" data-md-component="logo">
      
  <img src="../../assets/images/Cloud-Logo-Square.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            STFC Azimuth Science Platform
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Identity Provider
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stfc/cloud-azimuth-user-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="STFC Azimuth Science Platform" class="md-nav__button md-logo" aria-label="STFC Azimuth Science Platform" data-md-component="logo">
      
  <img src="../../assets/images/Cloud-Logo-Square.png" alt="logo">

    </a>
    STFC Azimuth Science Platform
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stfc/cloud-azimuth-user-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Platforms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Platforms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1">
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2">
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes Applications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-applications/argocd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ArgoCD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-applications/binderhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BinderHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-applications/daskhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DaskHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-applications/jupyterhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JupyterHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-applications/kubeflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KubeFlow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3">
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes Cluster Addons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes Cluster Addons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-cluster-addons/kubernetes_dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes Dashboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../platforms/kubernetes-cluster-addons/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Identity Provider
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Identity Provider
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-identity-management" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Identity Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to Identity Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groups-example" class="md-nav__link">
    <span class="md-ellipsis">
      Groups Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bulk-importing-users" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk Importing Users
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-an-iam-based-identity-provider" class="md-nav__link">
    <span class="md-ellipsis">
      Adding an IAM-Based Identity Provider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding an IAM-Based Identity Provider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manually-adding-users" class="md-nav__link">
    <span class="md-ellipsis">
      Manually Adding Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-access-to-a-certain-iam-group-and-assign-a-keycloak-group" class="md-nav__link">
    <span class="md-ellipsis">
      Restrict access to a certain IAM group, and assign a Keycloak group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assign-an-iam-group-to-a-keycloak-group" class="md-nav__link">
    <span class="md-ellipsis">
      Assign an IAM group to a Keycloak group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quotas/quotas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quotas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/machines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/volumes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Volumes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../known_issues/known_issues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Known Issues
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://stfc.atlassian.net/wiki/spaces/CLOUDKB/pages/1000702963/Azimuth+Memorandum+of+Understanding+MOU" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memorandum of Understanding
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-identity-management" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction to Identity Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to Identity Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groups-example" class="md-nav__link">
    <span class="md-ellipsis">
      Groups Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bulk-importing-users" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk Importing Users
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-an-iam-based-identity-provider" class="md-nav__link">
    <span class="md-ellipsis">
      Adding an IAM-Based Identity Provider
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding an IAM-Based Identity Provider">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manually-adding-users" class="md-nav__link">
    <span class="md-ellipsis">
      Manually Adding Users
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-access-to-a-certain-iam-group-and-assign-a-keycloak-group" class="md-nav__link">
    <span class="md-ellipsis">
      Restrict access to a certain IAM group, and assign a Keycloak group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assign-an-iam-group-to-a-keycloak-group" class="md-nav__link">
    <span class="md-ellipsis">
      Assign an IAM group to a Keycloak group
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  




  <h1>Identity Provider</h1>

<h3 id="introduction-to-identity-management">Introduction to Identity Management</h3>
<p>Azimuth has two kinds of users: "Platform Admins" who are able to sign into Azimuth, manage deployed platforms in a tenancy, and administer access to those platforms; and "Platform Users", who can access one or more platforms deployed onto Azimuth.</p>
<p>Only Platform Admins require an OpenStack account. This is because each azimuth tenancy (i.e. OpenStack Project) has an associated <a href="https://www.keycloak.org/docs/latest/server_admin/#configuring-realms">"realm"</a> in Keycloak. Keycloak is an Identity Management Platform, which allows platform access to be granted granularly per user.</p>
<p>For example, say you are running a workshop on JupyterHub. Using Keycloak, a project admin can create users in the associated realm for each workshop attendee. These attendees can then only be granted access to one specific JupyterHub deployment for the workshop, after which their access can be revoked.</p>
<p>Important concepts in Keycloak are Users, Clients, Realm Roles and Groups</p>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>Users</td>
<td>Individuals who can authenticate into the platform. In Keycloak, users can be created per realm, allowing fine-grained access control specific to each Azimuth tenancy.</td>
</tr>
<tr>
<td>Clients</td>
<td>Applications or services (e.g. JupyterHub) that users can access through Keycloak. Clients are configured within a realm and represent the endpoints that Keycloak secures.</td>
</tr>
<tr>
<td>Realm Roles</td>
<td>Permissions that can be assigned to users within a realm. These define what actions a user can perform and are often tied to specific clients or administrative functions.</td>
</tr>
<tr>
<td>Groups</td>
<td>Collections of users within a realm that allow for bulk assignment of roles and permissions.<br>Each realm typically includes at least two groups: <code>admins</code> and <code>platform-users</code>, along with unique roles for each deployment.<br><br><code>admins</code> have admin status for a realm, allowing them to perform actions on the Keycloak admin console.<br><br><code>platform-users</code> are granted access to <em>every</em> deployment in the realm.<br><br> Alternatively, the unique groups for each deployment can be used to grant access to a single deployment. Additionally, subgroups are created which can grant access to a single service under that deployment.</td>
</tr>
</tbody>
</table>
<h4 id="groups-example">Groups Example</h4>
<p>Consider a Kubernetes cluster platform deployed under azimuth, <code>my-binderhub</code>. Two services are exposed under it if enabled, BinderHub and JupyterHub.</p>
<ul>
<li><code>platform-users</code> have access to both services, and every other deployment in the tenancy.</li>
<li>Users in the <code>kubeapp-my-binderhub</code> have access to both services, BinderHub and JupyterHub, but no other deployments.</li>
<li>Users in the <code>kubeapp-my-binderhub/my-binderhub-binderhub-azimuth-jupyterhub</code> group have access to the JupyterHub, but not BinderHub.</li>
</ul>
<p><strong>Admins can add users to these individual groups through the Keycloak dashboard, hence granting them access to individual services.</strong></p>
<h3 id="bulk-importing-users">Bulk Importing Users</h3>
<p>Bulk Importing/Generating a set of users can be achieved via a partial import to your Keycloak realm.</p>
<p>Here is a simple process to do so:</p>
<ol>
<li>Download this helper script <a download="csvToJsonConverterScript" href="../../assets/static/csvToJsonConverterScript.sh">csvToJsonConverterScript.sh</a></li>
<li>Set the script as executable with <code>chmod +x csvToJsonConverterScript.sh</code></li>
<li>Create a CSV file (in a spreadsheet editor, or a text editor), with the following format, i.e.:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nx">username</span><span class="cm">/*(1)!*/</span><span class="p">,</span><span class="nx">firstName</span><span class="cm">/*(2)!*/</span><span class="p">,</span><span class="nx">lastName</span><span class="cm">/*(3)!*/</span><span class="p">,</span><span class="nx">email</span><span class="cm">/*(4)!*/</span><span class="p">,</span><span class="nx">password</span><span class="cm">/*(5)!*/</span><span class="p">,</span><span class="nx">temporary</span><span class="cm">/*(6)!*/</span><span class="p">,</span><span class="nx">require_idp_link</span><span class="cm">/*(7)!*/</span><span class="p">,</span><span class="nx">realmRoles</span><span class="cm">/*(8)!*/</span><span class="p">,</span><span class="nx">groups</span><span class="cm">/*(9)!*/</span>
<span class="nx">mpython</span><span class="p">,</span><span class="nx">Monty</span><span class="p">,</span><span class="nx">Python</span><span class="p">,</span><span class="nx">mpython</span><span class="err">@</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">,</span><span class="nx">Password123</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="kc">false</span><span class="p">,</span><span class="nx">some_role</span><span class="p">,</span><span class="nx">some_group</span>
<span class="nx">gzilla</span><span class="p">,</span><span class="nx">God</span><span class="p">,</span><span class="nx">Zilla</span><span class="p">,</span><span class="nx">gzilla</span><span class="err">@</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">,</span><span class="nx">Password456</span><span class="p">,</span><span class="kc">true</span><span class="p">,</span><span class="kc">true</span><span class="p">,</span><span class="nx">some_role</span><span class="p">;</span><span class="nx">some_second_role</span><span class="p">,</span><span class="nx">some_group</span><span class="p">;</span><span class="nx">some_second_group</span>
</code></pre></div>
<ol>
<li>Username. If using IAM authentication, this should be FedID.</li>
<li>First Name</li>
<li>Last Name</li>
<li>Email Address</li>
<li>Initial Password</li>
<li>One of <code>true</code> or <code>false</code>. If <code>true</code>, the user will be prompted to change their password.</li>
<li>One of <code>true</code> or <code>false</code>. If <code>true</code>, the user will be prompted to connect their account to an identity provider, i.e. Azimuth's Keystone-based default provider, or a custom provider you have set up i.e. IAM.</li>
<li>A semicolon separated list of realm roles to assign to the user</li>
<li>A semicolon separated list of groups to assign to the user</li>
</ol>
<p></p>
<ol start="3">
<li>Run the script to generate an equivalent JSON file with <code>./csvToJsonConverterScript.sh &lt;input_file&gt; &lt;output_file&gt;</code><ol>
<li>I.e. <code>./csvToJsonConverterScript.sh myCreatedUserCSV.csv someOutputJsonFile.json</code></li>
</ol>
</li>
<li>On Keycloak, go to <em>Realm Settings</em><br>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/images/keycloak-realm-settings.png" data-desc-position="bottom"><img alt="Realm Settings" loading="lazy" src="../../assets/images/keycloak-realm-settings.png"></a></li>
<li>Click <em>Actions</em>, then <em>Partial Import</em> in the top left<br>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/images/keycloak-partial-import.png" data-desc-position="bottom"><img alt="Partial Import button" loading="lazy" src="../../assets/images/keycloak-partial-import.png"></a></li>
<li>Browse for and upload the JSON output, and check it for sanity, i.e. check the number of users, and the properties of the json
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/images/keycloak-user-import.png" data-desc-position="bottom"><img alt="Importing users" loading="lazy" src="../../assets/images/keycloak-user-import.png"></a></li>
<li>Click import, and wait for it to complete</li>
<li>Check the Users tab for the created users</li>
</ol>
<h3 id="adding-an-iam-based-identity-provider">Adding an IAM-Based Identity Provider</h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This process hasn't yet been fully tested and explored against user use cases. Please reach out with comments, improvements or issues; and carefully consider each step</p>
</div>
<p>In addition to allowing login via the same account interface as OpenStack (via Keystone, through the Azimuth identity provider), an additional custom identity provider can be setup.</p>
<p>This can, for example, use IRIS-IAM/SKA-IAM.
Users can then link their accounts to allow logging in through IAM; or groups can be assigned based on IAM groups (for example, to allow access to JupyterHub for all users in a research group)</p>
<p>To set this up:</p>
<ol>
<li>On Keycloak, open Identity Providers from the sidebar</li>
<li>Press Add Provider → OpenID Connect v1.0</li>
<li>Set the Alias to something identifiable, i.e. "iris-iam"</li>
<li>Set the Display Name to be a human-readable equivalent, i.e. "IRIS-IAM" </li>
<li>Copy the Redirect URI</li>
<li>Visit your IAM interface, for example https://iris-iam.stfc.ac.uk/ or https://ska-iam.stfc.ac.uk/, and login</li>
<li>Visit "My Clients" in the top left, and press New Client</li>
<li>Add a Redirect URI from the URI you copied from Keycloak</li>
<li>Set the client name, description, and contact email</li>
<li>In the Scopes tab, ensure <code>openid</code>, <code>profile</code>, <code>email</code>, and <code>preferred_username</code> are checked</li>
<li>In the Credentials tab, set <code>Token endpoint authentication method</code> to <code>Client secret over HTTP POST authentication</code></li>
<li>Save the client</li>
<li>In the Main tab, copy the Client ID</li>
<li>Back in Keycloak, paste the Client ID</li>
<li>In IAM, in the credentials tab, copy the Client Secret</li>
<li>In Keycloak, paste the Client Secret</li>
<li>Use Discovery Endpoint is checked, then use one of:<br>
<code>https://iris-iam.stfc.ac.uk/.well-known/openid-configuration</code><br>
<code>https://ska-iam.stfc.ac.uk/.well-known/openid-configuration</code></li>
<li>Ensure Client Authentication is set to "Client secret sent as post"</li>
<li>Press Add</li>
<li>Open the newly added provider</li>
<li>Under OpenID Connect settings → Advanced, set "Scopes" to <code>openid profile email preferred_username</code></li>
<li>Under "Advanced Settings", set "First login flow override" to "azimuth first login"<ol>
<li>This is important as this authentication flow disables the "Review Profile" step which is present in the default broker login flow. Otherwise, users could create new users with any username of their choice.</li>
</ol>
</li>
<li>Press Save</li>
</ol>
<p>You now have a minimally functional login provider, allowing user accounts to be linked to IAM.</p>
<p>Existing users from the Azimuth provider (i.e. yourself) should be prompted to link their account to IAM when they log in.</p>
<h4 id="manually-adding-users">Manually Adding Users</h4>
<p>The default behaviour for new users logging in with IAM is to create them an account automatically. This user account can then be granted access to services manually via groups.</p>
<p>Alternatively, users can be pre-created then connect their account to IAM upon first login. A new user with their username and a temporary password can be created and assigned groups. When logging in for the first time with IAM, the account matching their username will link to it.</p>
<h4 id="restrict-access-to-a-certain-iam-group-and-assign-a-keycloak-group">Restrict access to a certain IAM group, and assign a Keycloak group</h4>
<p>As stated above, the default behaviour for an unknown user is to automatically create a Keycloak account. Access to IAM can be restricted to users with a specific <code>claim</code>, for example IAM group or profile information like email address. The following example shows how to restrict login based on the <code>groups</code> claim.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an IAM group doesn't yet exist for your team, you should contact your IAM team for support in creating one.</p>
</div>
<ol>
<li>Under Keycloak → Identity Providers, open your custom OpenID identity provider for IAM</li>
<li>Under Advanced Settings, enable "Verify essential Claim"</li>
<li>For Essential claim, enter <code>groups</code><ol>
<li>For other use cases, this can be any claim allowed by your set of OpenID scopes. See the INDIGO IAM documentation.</li>
</ol>
</li>
<li>Essential claim value can take a RegEx string. For example, <code>.*stfc-cloud.*</code> to require all users be in the <code>stfc-cloud</code> IAM group. Remember to properly escape RegEx characters, and be aware this example string allows for any group name that contains the sub-string <code>stfc-cloud</code>.</li>
</ol>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../assets/images/keycloak-essential-claim.png" data-desc-position="bottom"><img alt="Essential Claim settings" loading="lazy" src="../../assets/images/keycloak-essential-claim.png"></a></p>
<h4 id="assign-an-iam-group-to-a-keycloak-group">Assign an IAM group to a Keycloak group</h4>
<p>In addition to restricting login based on <code>claim</code>, Mappers can be used to assign Keycloak groups or other user properties based on them. For example, to assign all users in the <code>stfc-cloud</code> group access to a service like JupyterHub</p>
<ol>
<li>Under Keycloak → Identity Providers, open your custom OpenID identity provider for IAM</li>
<li>At the top, visit the Mappers tab and press Add Mapper</li>
<li>If as above you have already restricted access via Essential Claim to your group, you can simply select Hardcoded Group → Select your JupyterHub access group<ol>
<li>Alternately, there are more advanced mapper types, some of which themselves support RegEx requirements</li>
<li>For example, to allow all users to login but only allow a certain IAM group to access JupyterHub:<ol>
<li>Mapper type: Advanced Claim to Group</li>
<li>"Add Claims" → Key <code>groups</code>, value <code>.*stfc-cloud.*</code></li>
<li>Enable "RegEx claim values"</li>
<li>Set the JupyterHub service-specific group to grant at the bottom</li>
</ol>
</li>
</ol>
</li>
<li>Press Save, after naming it</li>
</ol>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 17, 2025 12:27:21 UTC">September 17, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 17, 2025 12:27:21 UTC">September 17, 2025</span>
  </span>

    
    
    
  </aside>



  



                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 Science and Technology Facilities Council<br>
Licensed under the Apache License, Version 2.0.

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "content.code.copy", "content.code.annotate", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>